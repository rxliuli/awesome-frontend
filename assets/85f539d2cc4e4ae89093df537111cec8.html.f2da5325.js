import{r as n,o as s,c as a,a as e,F as t,b as o}from"./app.55fed6f8.js";const c={},l=e("h2",{id:"场景",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#场景","aria-hidden":"true"},"#"),o(" 场景")],-1),p=e("p",null,"在很多生产项目中，我们希望自定义 electron 窗口顶栏，因为它确实非常简陋。",-1),r=e("h2",{id:"步骤",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#步骤","aria-hidden":"true"},"#"),o(" 步骤")],-1),u=e("h3",{id:"在渲染层实现自定义顶栏",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#在渲染层实现自定义顶栏","aria-hidden":"true"},"#"),o(" 在渲染层实现自定义顶栏")],-1),i=e("p",null,[o("实际上，核心的代码就是添加一个为顶栏的元素添加 css 样式。在 electron 环境，有 "),e("code",null,"-webkit-app-region: drag;"),o(" 属性的元素可以拖动整个窗口。")],-1),k=e("div",{class:"language-css ext-css line-numbers-mode"},[e("pre",{class:"language-css"},[e("code",null,[e("span",{class:"token selector"},".toolbar"),o(),e("span",{class:"token punctuation"},"{"),o("\n  "),e("span",{class:"token property"},"-webkit-app-region"),e("span",{class:"token punctuation"},":"),o(" drag"),e("span",{class:"token punctuation"},";"),o("\n"),e("span",{class:"token punctuation"},"}"),o("\n"),e("span",{class:"token selector"},".toolbar > *"),o(),e("span",{class:"token punctuation"},"{"),o("\n  "),e("span",{class:"token property"},"-webkit-app-region"),e("span",{class:"token punctuation"},":"),o(" no-drag"),e("span",{class:"token punctuation"},";"),o("\n"),e("span",{class:"token punctuation"},"}"),o("\n")])]),e("div",{class:"line-numbers"},[e("span",{class:"line-number"},"1"),e("br"),e("span",{class:"line-number"},"2"),e("br"),e("span",{class:"line-number"},"3"),e("br"),e("span",{class:"line-number"},"4"),e("br"),e("span",{class:"line-number"},"5"),e("br"),e("span",{class:"line-number"},"6"),e("br")])],-1),b=e("p",null,"上面的 css 看起来有点奇怪，但这是为了避免子元素（例如关闭按钮）也可以拖动的错误。",-1),d={href:"https://www.electronjs.org/docs/api/browser-window#event-system-context-menu-windows",target:"_blank",rel:"noopener noreferrer"},m=o("参考文档"),w=o(", "),f={href:"https://github.com/rxliuli/electron_example/blob/18a1a756e5c82e87ef1c8755a0be036b6765f04b/apps/renderer/src/components/router/component/BasicLayout.module.css#L13",target:"_blank",rel:"noopener noreferrer"},g=o("参考代码"),h=e("h3",{id:"使用-electron-通信实现窗口的三个操作",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#使用-electron-通信实现窗口的三个操作","aria-hidden":"true"},"#"),o(" 使用 electron 通信实现窗口的三个操作")],-1),y=e("p",null,[o("其实，electron 本身支持在渲染层暴露 "),e("code",null,"remote"),o(" 模块，但这里我们选择使用 "),e("code",null,"ipcRenderer/ipcMain"),o(" 手动实现，remote 模块因为安全原因默认被禁用了。")],-1),x=e("p",null,[o("下面的步骤基本和 "),e("a",{href:"/p/76393a60949c47c7add910df0206734c"},"渲染、主进程通信"),o(" 所属一样，下面贴一些关键代码")],-1),v=e("p",null,"共享类型",-1),W=e("div",{class:"language-typescript ext-ts line-numbers-mode"},[e("pre",{class:"language-typescript"},[e("code",null,[e("span",{class:"token comment"},"// WindowDefine.ts"),o("\n"),e("span",{class:"token keyword"},"import"),o(),e("span",{class:"token punctuation"},"{"),o(" BaseDefine "),e("span",{class:"token punctuation"},"}"),o(),e("span",{class:"token keyword"},"from"),o(),e("span",{class:"token string"},'"electron_ipc_type"'),e("span",{class:"token punctuation"},";"),o("\n\n"),e("span",{class:"token keyword"},"export"),o(),e("span",{class:"token keyword"},"interface"),o(),e("span",{class:"token class-name"},"WindowDefine"),o(),e("span",{class:"token keyword"},"extends"),o(),e("span",{class:"token class-name"},[o("BaseDefine"),e("span",{class:"token operator"},"<"),e("span",{class:"token string"},'"WindowApi"'),e("span",{class:"token operator"},">")]),o(),e("span",{class:"token punctuation"},"{"),o("\n  "),e("span",{class:"token function"},"action"),e("span",{class:"token punctuation"},"("),o("type"),e("span",{class:"token operator"},":"),o(),e("span",{class:"token string"},'"min"'),o(),e("span",{class:"token operator"},"|"),o(),e("span",{class:"token string"},'"max"'),o(),e("span",{class:"token operator"},"|"),o(),e("span",{class:"token string"},'"close"'),e("span",{class:"token punctuation"},")"),e("span",{class:"token operator"},":"),o(),e("span",{class:"token keyword"},"void"),e("span",{class:"token punctuation"},";"),o("\n"),e("span",{class:"token punctuation"},"}"),o("\n")])]),e("div",{class:"line-numbers"},[e("span",{class:"line-number"},"1"),e("br"),e("span",{class:"line-number"},"2"),e("br"),e("span",{class:"line-number"},"3"),e("br"),e("span",{class:"line-number"},"4"),e("br"),e("span",{class:"line-number"},"5"),e("br"),e("span",{class:"line-number"},"6"),e("br")])],-1),B=e("p",null,"主进程",-1),A=e("div",{class:"language-typescript ext-ts line-numbers-mode"},[e("pre",{class:"language-typescript"},[e("code",null,[e("span",{class:"token comment"},"// main.ts"),o("\n"),e("span",{class:"token keyword"},"class"),o(),e("span",{class:"token class-name"},"WindowApi"),o(),e("span",{class:"token punctuation"},"{"),o("\n  "),e("span",{class:"token keyword"},"async"),o(),e("span",{class:"token function"},"action"),e("span",{class:"token punctuation"},"("),o("e"),e("span",{class:"token operator"},":"),o(" IpcMainInvokeEvent"),e("span",{class:"token punctuation"},","),o(" type"),e("span",{class:"token operator"},":"),o(),e("span",{class:"token string"},'"min"'),o(),e("span",{class:"token operator"},"|"),o(),e("span",{class:"token string"},'"max"'),o(),e("span",{class:"token operator"},"|"),o(),e("span",{class:"token string"},'"close"'),e("span",{class:"token punctuation"},")"),o(),e("span",{class:"token punctuation"},"{"),o("\n    "),e("span",{class:"token keyword"},"const"),o(" win "),e("span",{class:"token operator"},"="),o(" BrowserWindow"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"fromWebContents"),e("span",{class:"token punctuation"},"("),o("e"),e("span",{class:"token punctuation"},"."),o("sender"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),o("\n    "),e("span",{class:"token keyword"},"switch"),o(),e("span",{class:"token punctuation"},"("),o("type"),e("span",{class:"token punctuation"},")"),o(),e("span",{class:"token punctuation"},"{"),o("\n      "),e("span",{class:"token keyword"},"case"),o(),e("span",{class:"token string"},'"min"'),e("span",{class:"token operator"},":"),o("\n        win"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"minimize"),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),o("\n        "),e("span",{class:"token keyword"},"break"),e("span",{class:"token punctuation"},";"),o("\n      "),e("span",{class:"token keyword"},"case"),o(),e("span",{class:"token string"},'"max"'),e("span",{class:"token operator"},":"),o("\n        win"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"isMaximized"),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},")"),o(),e("span",{class:"token operator"},"?"),o(" win"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"unmaximize"),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},")"),o(),e("span",{class:"token operator"},":"),o(" win"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"maximize"),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),o("\n        "),e("span",{class:"token keyword"},"break"),e("span",{class:"token punctuation"},";"),o("\n      "),e("span",{class:"token keyword"},"case"),o(),e("span",{class:"token string"},'"close"'),e("span",{class:"token operator"},":"),o("\n        win"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"close"),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),o("\n        "),e("span",{class:"token keyword"},"break"),e("span",{class:"token punctuation"},";"),o("\n    "),e("span",{class:"token punctuation"},"}"),o("\n  "),e("span",{class:"token punctuation"},"}"),o("\n"),e("span",{class:"token punctuation"},"}"),o("\n")])]),e("div",{class:"line-numbers"},[e("span",{class:"line-number"},"1"),e("br"),e("span",{class:"line-number"},"2"),e("br"),e("span",{class:"line-number"},"3"),e("br"),e("span",{class:"line-number"},"4"),e("br"),e("span",{class:"line-number"},"5"),e("br"),e("span",{class:"line-number"},"6"),e("br"),e("span",{class:"line-number"},"7"),e("br"),e("span",{class:"line-number"},"8"),e("br"),e("span",{class:"line-number"},"9"),e("br"),e("span",{class:"line-number"},"10"),e("br"),e("span",{class:"line-number"},"11"),e("br"),e("span",{class:"line-number"},"12"),e("br"),e("span",{class:"line-number"},"13"),e("br"),e("span",{class:"line-number"},"14"),e("br"),e("span",{class:"line-number"},"15"),e("br"),e("span",{class:"line-number"},"16"),e("br"),e("span",{class:"line-number"},"17"),e("br")])],-1),_=e("p",null,"渲染进程",-1),M=e("div",{class:"language-typescript ext-ts line-numbers-mode"},[e("pre",{class:"language-typescript"},[e("code",null,[e("span",{class:"token comment"},"// BasicLayout.tsx"),o("\n"),e("span",{class:"token keyword"},"const"),o(" windowApi "),e("span",{class:"token operator"},"="),o(" IpcRendererClient"),e("span",{class:"token punctuation"},"."),e("span",{class:"token generic-function"},[e("span",{class:"token function"},"gen"),e("span",{class:"token generic class-name"},[e("span",{class:"token operator"},"<"),o("WindowDefine"),e("span",{class:"token operator"},">")])]),e("span",{class:"token punctuation"},"("),e("span",{class:"token string"},'"WindowApi"'),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),o("\n\n"),e("span",{class:"token doc-comment comment"},"/**\n * 封装 electron 的窗口控制 hooks\n */"),o("\n"),e("span",{class:"token keyword"},"function"),o(),e("span",{class:"token function"},"useElectronWindowControl"),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},")"),o(),e("span",{class:"token punctuation"},"{"),o("\n  "),e("span",{class:"token keyword"},"return"),o(),e("span",{class:"token punctuation"},"{"),o("\n    "),e("span",{class:"token function-variable function"},"handleMin"),e("span",{class:"token operator"},":"),o(),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},")"),o(),e("span",{class:"token operator"},"=>"),o(" windowApi"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"action"),e("span",{class:"token punctuation"},"("),e("span",{class:"token string"},'"min"'),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},","),o("\n    "),e("span",{class:"token function-variable function"},"handleMax"),e("span",{class:"token operator"},":"),o(),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},")"),o(),e("span",{class:"token operator"},"=>"),o(" windowApi"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"action"),e("span",{class:"token punctuation"},"("),e("span",{class:"token string"},'"max"'),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},","),o("\n    "),e("span",{class:"token function-variable function"},"handleClose"),e("span",{class:"token operator"},":"),o(),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},")"),o(),e("span",{class:"token operator"},"=>"),o(" windowApi"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"action"),e("span",{class:"token punctuation"},"("),e("span",{class:"token string"},'"close"'),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},","),o("\n  "),e("span",{class:"token punctuation"},"}"),e("span",{class:"token punctuation"},";"),o("\n"),e("span",{class:"token punctuation"},"}"),o("\n")])]),e("div",{class:"line-numbers"},[e("span",{class:"line-number"},"1"),e("br"),e("span",{class:"line-number"},"2"),e("br"),e("span",{class:"line-number"},"3"),e("br"),e("span",{class:"line-number"},"4"),e("br"),e("span",{class:"line-number"},"5"),e("br"),e("span",{class:"line-number"},"6"),e("br"),e("span",{class:"line-number"},"7"),e("br"),e("span",{class:"line-number"},"8"),e("br"),e("span",{class:"line-number"},"9"),e("br"),e("span",{class:"line-number"},"10"),e("br"),e("span",{class:"line-number"},"11"),e("br"),e("span",{class:"line-number"},"12"),e("br"),e("span",{class:"line-number"},"13"),e("br")])],-1),D={href:"https://github.com/rxliuli/electron_example/tree/3aea837b0c7661e030406a0c20d306694402a26f",target:"_blank",rel:"noopener noreferrer"},I=o("参考代码"),z=e("h3",{id:"隐藏掉默认的顶栏",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#隐藏掉默认的顶栏","aria-hidden":"true"},"#"),o(" 隐藏掉默认的顶栏")],-1),C=e("p",null,[o("实际上，只要在创建 electron 的 "),e("code",null,"BrowserWindow"),o(" 实例时配置即可")],-1),L=e("div",{class:"language-typescript ext-ts line-numbers-mode"},[e("pre",{class:"language-typescript"},[e("code",null,[e("span",{class:"token keyword"},"new"),o(),e("span",{class:"token class-name"},"BrowserWindow"),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},"{"),o("\n  webPreferences"),e("span",{class:"token operator"},":"),o(),e("span",{class:"token punctuation"},"{"),o("\n    nodeIntegration"),e("span",{class:"token operator"},":"),o(),e("span",{class:"token boolean"},"true"),e("span",{class:"token punctuation"},","),o("\n  "),e("span",{class:"token punctuation"},"}"),e("span",{class:"token punctuation"},","),o("\n  frame"),e("span",{class:"token operator"},":"),o(),e("span",{class:"token boolean"},"false"),e("span",{class:"token punctuation"},","),o("\n  autoHideMenuBar"),e("span",{class:"token operator"},":"),o(),e("span",{class:"token boolean"},"true"),e("span",{class:"token punctuation"},","),o("\n"),e("span",{class:"token punctuation"},"}"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),o("\n")])]),e("div",{class:"line-numbers"},[e("span",{class:"line-number"},"1"),e("br"),e("span",{class:"line-number"},"2"),e("br"),e("span",{class:"line-number"},"3"),e("br"),e("span",{class:"line-number"},"4"),e("br"),e("span",{class:"line-number"},"5"),e("br"),e("span",{class:"line-number"},"6"),e("br"),e("span",{class:"line-number"},"7"),e("br")])],-1),j=e("p",null,"现在，electron 程序就有自定义顶栏啦",-1),q=e("p",null,[e("img",{src:"/assets/92f7aa2fcd894107b05056f5c662e051.9f3b253e.png",alt:"1611134001681.png"})],-1),E=e("h2",{id:"问题",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#问题","aria-hidden":"true"},"#"),o(" 问题")],-1),R=e("p",null,"虽然自定义窗口顶栏有很多优点，但也并非尽善尽美，已知缺点如下",-1),F=e("ul",null,[e("li",null,"占有了一定高度，导致一些 UI 组件的位置很奇怪，例如顶部的消息提示框和侧边抽屉，会遮挡住窗口顶栏的一部分。"),e("li",null,"可能随着系统升级与系统风格不搭，早有人吐槽过 Windows 所有程序的自定义顶栏都是不一样的高度和大小，非常丑"),e("li",null,[o("需要重新实现窗口菜单相关的快捷键，例如 "),e("code",null,"ctrl+shift+i"),o(" 打开开发者工具")]),e("li",null,"在 mac 上需要进行特别的兼容，否则和其他程序会显得格格不入")],-1);c.render=function(o,c){const H=n("OutboundLink");return s(),a(t,null,[l,p,r,u,i,k,b,e("blockquote",null,[e("p",null,[e("a",d,[m,e(H)]),w,e("a",f,[g,e(H)])])]),h,y,x,v,W,B,A,_,M,e("blockquote",null,[e("p",null,[e("a",D,[I,e(H)])])]),z,C,L,j,q,E,R,F],64)};export{c as default};
